// ------------------------------------------------------
// Prisma/DB
// ------------------------------------------------------
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ------------------------------------------------------
// Enums
// ------------------------------------------------------
enum Role {
  USER
  ADMIN
}

enum CEFRLevel {
  A1
  A2
  B1
  B2
  C1
  C2
}

enum Skill {
  LISTENING
  READING
  WRITING
  SPEAKING
  GRAMMAR
  VOCABULARY
  PRONUNCIATION
  FUNCTIONAL_LANGUAGE
  MEDIATION
  ASSESSMENT
  CULTURE
}

enum ModuleType {
  LISTENING
  READING
  WRITING
  SPEAKING
  GRAMMAR_STRUCTURE
  VOCAB_LEXICAL
  PRONUNCIATION_PHONETICS
  FUNCTIONAL_COMMUNICATION
  MEDIATION_TRANSLATION
  TEST_REVIEW
  CULTURE_TOPICS_CONTENT
}

enum ActivityType {
  LECTURE // b√†i h·ªçc l√Ω thuy·∫øt/gi·ªõi thi·ªáu
  LISTEN_FIND_ERROR // nghe b·∫Øt l·ªói
  LISTEN_DETAIL // nghe hi·ªÉu chi ti·∫øt
  LISTEN_GIST // nghe √Ω ch√≠nh
  READ_MAIN_IDEA // ƒë·ªçc t√¨m √Ω ch√≠nh
  READ_INFER // ƒë·ªçc suy lu·∫≠n
  READ_SKIMMING // ƒë·ªçc t·ªïng qu√°t
  WRITE_SENTENCE
  WRITE_PARAGRAPH
  WRITE_EMAIL
  WRITE_SHORT_ESSAY
  SPEAK_TOPIC
  SPEAK_ROLE_PLAY
  SPEAK_DESCRIPTION
  GRAMMAR_FILL_BLANK
  GRAMMAR_TRANSFORMATION
  VOCAB_MATCHING
  VOCAB_CLZE
  PRONUN_MINIMAL_PAIR
  PRONUN_STRESS
  PRONUN_INTONATION
  FUNCTIONAL_DIALOG
  MEDIATION_SUMMARIZE
  MEDIATION_REPHRASE
  ASSESS_SECTION // ph·∫ßn thi (nghe/ƒë·ªçc/n√≥i/vi·∫øt)
}

enum QuestionType {
  SINGLE_CHOICE
  MULTI_CHOICE
  TRUE_FALSE
  SHORT_TEXT
  LONG_TEXT
  ORDERING
  MATCHING
  GAP_FILL
  AUDIO_RECORD // n·ªôp file/ghi √¢m
  FILE_UPLOAD
}

enum MediaType {
  AUDIO
  VIDEO
  IMAGE
  TEXT
  PDF
}

enum NotificationType {
  AUTOMATIC
  MANUAL
}

enum NotificationTrigger {
  STREAK_WARNING      // Th√¥ng b√°o s·∫Øp h·∫øt chu·ªói
  PRACTICE_REMINDER   // Nh·∫Øc nh·ªü l√†m b√†i t·∫≠p
  STREAK_EXPIRED      // Qu√° h·∫°n, nh·∫Øc v√†o h·ªçc ƒë·ªÉ gi·ªØ chu·ªói
}

// ------------------------------------------------------
// Auth (NextAuth.js 5+)
// ------------------------------------------------------
model User {
  id            String    @id @default(cuid())
  name          String?
  email         String?   @unique
  emailVerified DateTime?
  image         String?
  password      String?   // For email/password auth

  role Role @default(USER)

  // Placement test & level
  placementTestCompleted Boolean   @default(false)
  cefrLevel              String?   // A1, A2, B1, B2, C1, C2
  placementScore         Int?
  lastActive             DateTime?
  streak                 Int       @default(0)
  longestStreak          Int       @default(0)

  // User preferences
  language               String    @default("en") // en, vi
  theme                  String    @default("light") // light, dark

  // h·ªçc t·∫≠p
  progress    UserProgress[]
  attempts    Attempt[]
  submissions Submission[]   @relation("SubmissionOwner") // <-- th√™m t√™n quan h·ªá
  gradedSubs  Submission[]   @relation("SubmissionGrader") // <-- m·ªõi: nh·ªØng b√†i do user n√†y ch·∫•m
  recordings  Recording[]
  userActivities  UserActivity[]
  goals       UserGoal[]
  placementTests PlacementTestResult[]
  writingLLMUsage WritingLLMUsage[]

  // authoring
  contents   Content[]  @relation("AuthorContents")
  activities Activity[] @relation("AuthorActivities")
  questions  Question[] @relation("AuthorQuestions")
  authoredNotifications Notification[] @relation("AuthoredNotifications")
  userNotifications UserNotification[] @relation("UserNotifications")

  accounts Account[]
  sessions Session[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

// ------------------------------------------------------
// Taxonomy / Tagging
// ------------------------------------------------------
model Topic {
  id          String    @id @default(cuid())
  slug        String    @unique
  title       String
  description String?
  contents    Content[] @relation("TopicsOnContents")
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Tag {
  id        String    @id @default(cuid())
  name      String    @unique
  contents  Content[] @relation("TagsOnContents") // ƒë·∫∑t t√™n quan h·ªá
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

// ------------------------------------------------------
// Content hierarchy: Module -> Unit(Lesson) -> Activity
// ------------------------------------------------------
model Module {
  id          String     @id @default(cuid())
  code        String     @unique
  type        ModuleType
  title       String
  description String?
  levelMin    CEFRLevel  @default(A1)
  levelMax    CEFRLevel  @default(C2)

  units Unit[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([type])
}

model Unit {
  id       String    @id @default(cuid())
  moduleId String
  order    Int       @default(1)
  title    String
  overview String?
  level    CEFRLevel
  skill    Skill

  module     Module     @relation(fields: [moduleId], references: [id], onDelete: Cascade)
  contents   Content[] // m√¥ t·∫£/ngu·ªìn
  activities Activity[]

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  UserProgress UserProgress[]

  @@index([moduleId, order])
  @@index([skill, level])
}

// N·ªôi dung h·ªçc li·ªáu (b√†i ƒë·ªçc, audio, transcript, realia, link‚Ä¶)
model Content {
  id        String    @id @default(cuid())
  unitId    String
  authorId  String?
  title     String
  summary   String?
  sourceUrl String?
  level     CEFRLevel
  skill     Skill
  locale    String    @default("en") // ng√¥n ng·ªØ ngu·ªìn
  html      String? // rich text ƒë√£ sanitize
  plainText String? // fallback
  metadata  Json?

  unit   Unit         @relation(fields: [unitId], references: [id], onDelete: Cascade)
  author User?        @relation("AuthorContents", fields: [authorId], references: [id])
  media  MediaAsset[]
  topics Topic[]      @relation("TopicsOnContents")
  tags   Tag[]        @relation("TagsOnContents")

  createdAt           DateTime           @default(now())
  updatedAt           DateTime           @updatedAt
  Question            Question[]
  GrammarPoint        GrammarPoint?      @relation(fields: [grammarPointId], references: [id])
  grammarPointId      String?
  VocabEntry          VocabEntry?        @relation(fields: [vocabEntryId], references: [id])
  vocabEntryId        String?
  PronunciationItem   PronunciationItem? @relation(fields: [pronunciationItemId], references: [id])
  pronunciationItemId String?

  @@index([unitId])
  @@index([skill, level])
}

model MediaAsset {
  id        String    @id @default(cuid())
  contentId String?
  url       String
  type      MediaType
  durationS Int? // cho audio/video
  mime      String?
  meta      Json?

  content    Content?   @relation(fields: [contentId], references: [id], onDelete: SetNull)
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  Activity   Activity?  @relation(fields: [activityId], references: [id])
  activityId String?
  Question   Question[]
}

// ------------------------------------------------------
// Activity (b√†i t·∫≠p/b√†i n√≥i/b√†i vi·∫øt/section ƒë√°nh gi√°‚Ä¶) & c√¢u h·ªèi
// ------------------------------------------------------
model Activity {
  id           String       @id @default(cuid())
  unitId       String
  authorId     String?
  type         ActivityType
  title        String
  instruction  String?
  maxScore     Int? // t·ªïng ƒëi·ªÉm
  timeLimitSec Int? // n·∫øu l√† test/section
  level        CEFRLevel
  skill        Skill

  unit      Unit         @relation(fields: [unitId], references: [id], onDelete: Cascade)
  author    User?        @relation("AuthorActivities", fields: [authorId], references: [id])
  media     MediaAsset[] // audio/video k√®m ho·∫°t ƒë·ªông (nghe/n√≥i)
  questions Question[]
  attempts  Attempt[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([unitId, type])
  @@index([skill, level])
}

model Question {
  id          String       @id @default(cuid())
  activityId  String
  authorId    String?
  order       Int          @default(1)
  type        QuestionType
  prompt      String // HTML ho·∫∑c Markdown ƒë√£ sanitize
  explanation String?
  score       Int          @default(1)
  data        Json? // c·∫•u tr√∫c ph·ª•: pairs cho matching, gaps cho gap-fill‚Ä¶
  // cho nghe/ƒë·ªçc: li√™n k·∫øt ƒë·∫øn media ho·∫∑c content c·ª• th·ªÉ
  mediaId     String?
  contentId   String?

  activity    Activity           @relation(fields: [activityId], references: [id], onDelete: Cascade)
  author      User?              @relation("AuthorQuestions", fields: [authorId], references: [id])
  media       MediaAsset?        @relation(fields: [mediaId], references: [id], onDelete: SetNull)
  content     Content?           @relation(fields: [contentId], references: [id], onDelete: SetNull)
  choices     Choice[]
  answers     AnswerKey[] // ƒë√°p √°n ƒë√∫ng (nhi·ªÅu n·∫øu MULTI_CHOICE/matching/gap-fill)
  submissions AnswerSubmission[]

  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt
  Submission Submission[]

  @@index([activityId, order])
}

model Choice {
  id         String  @id @default(cuid())
  questionId String
  order      Int     @default(1)
  text       String // ho·∫∑c HTML
  value      String? // gi√° tr·ªã n·ªôi b·ªô
  isCorrect  Boolean @default(false) // redundancy ƒë·ªÉ check nhanh MCQ

  question Question @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId, order])
}

model AnswerKey {
  id         String @id @default(cuid())
  questionId String
  key        String // ƒë√°p √°n ƒë√∫ng (text/value), JSON n·∫øu ph·ª©c t·∫°p
  meta       Json?

  question Question @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId])
}

// ------------------------------------------------------
// N·ªôp b√†i / ch·∫•m ƒëi·ªÉm / ghi √¢m
// ------------------------------------------------------
model Attempt {
  id          String    @id @default(cuid())
  userId      String
  activityId  String
  startedAt   DateTime  @default(now())
  submittedAt DateTime?
  score       Int? // t·ªïng ƒëi·ªÉm attempt
  status      String    @default("in_progress") // in_progress | submitted | graded
  meta        Json?

  user        User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  activity    Activity     @relation(fields: [activityId], references: [id], onDelete: Cascade)
  submissions Submission[]

  @@unique([userId, activityId, startedAt])
  @@index([userId, activityId])
}

model Submission {
  id         String    @id @default(cuid())
  attemptId  String
  userId     String
  questionId String
  // l∆∞u b√†i n·ªôp theo d·∫°ng chung
  answerText String?
  answerJson Json?
  chosenIds  String[]
  isCorrect  Boolean?
  score      Int?
  feedback   String?
  gradedAt   DateTime?
  graderId   String?

  attempt  Attempt  @relation(fields: [attemptId], references: [id], onDelete: Cascade)
  user     User     @relation("SubmissionOwner", fields: [userId], references: [id], onDelete: Cascade)
  question Question @relation(fields: [questionId], references: [id], onDelete: Cascade)
  grader   User?    @relation("SubmissionGrader", fields: [graderId], references: [id])

  recordings Recording[]

  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  AnswerSubmission AnswerSubmission[]

  @@index([attemptId, questionId])
}

model Recording {
  id           String @id @default(cuid())
  submissionId String
  userId       String
  url          String
  durationS    Int?
  waveform     Json? // optional: l∆∞u sample ƒë·ªÉ render
  meta         Json?

  submission Submission @relation(fields: [submissionId], references: [id], onDelete: Cascade)
  user       User       @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@index([submissionId])
}

// ------------------------------------------------------
// Ki·∫øn th·ª©c ng√¥n ng·ªØ c√≥ c·∫•u tr√∫c (Grammar / Vocab / Pronunciation)
// c√≥ th·ªÉ li√™n k·∫øt v√†o Content ho·∫∑c Activity qua b·∫£ng n·ªëi
// ------------------------------------------------------
model GrammarPoint {
  id          String    @id @default(cuid())
  title       String
  level       CEFRLevel
  explanation String?
  patterns    String? // m√¥ t·∫£ c·∫•u tr√∫c
  examples    Json? // m·∫£ng v√≠ d·ª•

  contents  Content[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@index([level])
}

model VocabEntry {
  id           String     @id @default(cuid())
  lemma        String
  pos          String? // noun/verb/adj‚Ä¶
  phonetic     String?
  level        CEFRLevel?
  definition   String?
  examples     Json? // m·∫£ng v√≠ d·ª•
  synonyms     String[]
  antonyms     String[]
  families     String[] // word families
  collocations String[]
  idioms       String[]
  phrasalVerbs String[]

  contents Content[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([lemma])
}

model PronunciationItem {
  id          String     @id @default(cuid())
  title       String // v√≠ d·ª•: /Œ∏/ vs /√∞/, stress rules, linking rules
  level       CEFRLevel?
  description String?
  examples    Json?

  contents  Content[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

// ------------------------------------------------------
// Ti·∫øn ƒë·ªô ng∆∞·ªùi h·ªçc
// ------------------------------------------------------
model UserProgress {
  id       String    @id @default(cuid())
  userId   String
  unitId   String
  status   String    @default("not_started") // not_started | in_progress | completed
  lastSeen DateTime?
  scoreSum Int? // t·ªïng ƒëi·ªÉm t·ªët nh·∫•t
  meta     Json?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  unit Unit @relation(fields: [unitId], references: [id], onDelete: Cascade)

  @@unique([userId, unitId])
  @@index([status])
}

model AnswerSubmission {
  id           String @id @default(cuid())
  questionId   String
  submissionId String
  data         Json // chi ti·∫øt cho matching/order/gap-fill (mapping, th·ª© t·ª±‚Ä¶)

  question   Question   @relation(fields: [questionId], references: [id], onDelete: Cascade)
  submission Submission @relation(fields: [submissionId], references: [id], onDelete: Cascade)

  @@index([questionId])
  @@index([submissionId])
}

// ------------------------------------------------------
// OTP for Password Reset
// ------------------------------------------------------
model PasswordReset {
  id        String   @id @default(cuid())
  email     String
  otp       String
  expiresAt DateTime
  verified  Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([email])
  @@index([otp])
}

// ------------------------------------------------------
// User Activity Tracking for Progress & Streak
// ------------------------------------------------------
model UserActivity {
  id           String   @id @default(cuid())
  userId       String
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  date         DateTime @default(now())
  skill        String   // reading, writing, listening, speaking, grammar, vocabulary
  activityType String   // exercise, practice, test
  duration     Int?     // minutes
  score        Float?
  completed    Boolean  @default(false)
  metadata     Json?

  createdAt DateTime @default(now())

  @@index([userId, date])
  @@index([userId, skill])
}

// ------------------------------------------------------
// User Goals
// ------------------------------------------------------
model UserGoal {
  id        String    @id @default(cuid())
  userId    String
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  type      String    // daily_exercises, weekly_hours, target_level, skill_improvement
  target    Int
  current   Int       @default(0)
  deadline  DateTime?
  completed Boolean   @default(false)
  metadata  Json?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@index([userId, completed])
}

// ------------------------------------------------------
// Placement Test Results
// ------------------------------------------------------
model PlacementTestResult {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  score       Int
  totalQuestions Int   @default(20)
  cefrLevel   String
  answers     Json     // Store all answers and questions
  completedAt DateTime @default(now())

  @@index([userId])
  @@index([userId, completedAt])
}

// ------------------------------------------------------
// Writing LLM Feature Usage Tracking
// ------------------------------------------------------
model WritingLLMUsage {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  taskId    String?  // Writing task ID (optional, for per-task tracking)
  feature   String   // outline, brainstorm, thesis, language-pack, rephrase, expand
  usedAt    DateTime @default(now())
  metadata  Json?    // Additional data (task level, etc.)

  createdAt DateTime @default(now())

  @@index([userId, taskId, feature])
  @@index([userId, feature])
  @@index([usedAt])
}

// ------------------------------------------------------
// Admin Notifications
// ------------------------------------------------------
model Notification {
  id        String   @id @default(cuid())
  title     String
  message   String
  target    String   // "all", "A1", "B2", etc.
  authorId  String
  author    User     @relation("AuthoredNotifications", fields: [authorId], references: [id])
  sentAt    DateTime @default(now())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // New fields for notification management
  notificationType NotificationType @default(MANUAL) // AUTOMATIC or MANUAL
  trigger          NotificationTrigger? // For automatic notifications
  active           Boolean            @default(true) // Enable/disable notification
  scheduleTime     DateTime?          // For scheduled notifications
  conditions       Json?              // Additional conditions for automatic notifications
  targetUserIds    Json?              // Array of user IDs for targeted automatic notifications (null = all users)

  @@index([authorId])
  @@index([notificationType])
  @@index([trigger])
  @@index([active])
}

// User-specific notifications (sent to individual users)
model UserNotification {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation("UserNotifications", fields: [userId], references: [id], onDelete: Cascade)
  title     String
  message   String
  type      String   @default("info") // info, success, warning, error
  link      String?
  sentBy    String   // Admin user ID who sent this notification
  read      Boolean  @default(false)
  readAt    DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // Link to notification template (for automatic notifications)
  notificationId String? // Reference to Notification model if sent automatically

  @@index([userId])
  @@index([userId, read])
  @@index([sentBy])
  @@index([notificationId])
}

// ------------------------------------------------------
// Writing Tasks (for Writing Practice)
// ------------------------------------------------------
model WritingTask {
  id          String   @id @default(cuid())
  title       String
  type        String   // Sentence Building, Paragraph Writing, Email Writing, etc.
  level       String   // A1, A2, B1, B2, C1, C2
  prompt      String   @db.Text
  targetWords String   // e.g., "50-80 words"
  tips        String[] // Array of tip strings
  recommended Boolean  @default(false)
  icon        String?  @default("üìù")
  color       String?  @default("blue")
  order       Int      @default(0)
  active      Boolean  @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([level])
  @@index([type])
  @@index([active, order])
}

// ------------------------------------------------------
// Reading Tasks (for Reading Practice)
// ------------------------------------------------------
model ReadingTask {
  id            String   @id @default(cuid())
  title         String
  subtitle      String?
  cefr          String   // A1, A2, B1, B2, C1, C2
  genre         String   // Workplace Drama, News Article, etc.
  source        String?
  tags          String[] // Array of tag strings
  estimatedTime Int?     // minutes
  wordCount     Int?
  coverEmoji    String?  @default("üìñ")
  gradient      String?  // CSS gradient string
  readingSkills String[] // Array of skill strings
  keyIdeas      String[] // Array of key idea strings
  vocabulary    Json?    // Array of {word, meaning, example}
  contentSections Json?  // Array of {heading, summary?, paragraphs[]}
  exercises     Json?    // Array of exercise objects
  recommended   Boolean  @default(false)
  order         Int      @default(0)
  active        Boolean  @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([cefr])
  @@index([genre])
  @@index([active, order])
}

// ------------------------------------------------------
// Listening Tasks (for Listening Practice)
// ------------------------------------------------------
model ListeningTask {
  id          String   @id @default(cuid())
  title       String
  type        String   // Conversation, Podcast, Lecture, etc.
  level       String   // A1, A2, B1, B2, C1, C2
  description String   @db.Text
  duration    String   // e.g., "4:10"
  speakers    String   // e.g., "2 speakers"
  accent      String   // e.g., "American", "British"
  questions   Int      @default(0)
  tags        String[] // Array of tag strings
  recommended Boolean  @default(false)
  icon        String?  @default("üéß")
  color       String?  @default("blue")
  order       Int      @default(0)
  active      Boolean  @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([level])
  @@index([type])
  @@index([active, order])
}

// ------------------------------------------------------
// Speaking Tasks (for Speaking Practice)
// ------------------------------------------------------
model SpeakingTask {
  id          String   @id @default(cuid())
  title       String
  type        String   // Pronunciation, Topic Discussion, Role Play, etc.
  level       String   // A1, A2, B1, B2, C1, C2
  prompt      String   @db.Text
  timeLimit   String   // e.g., "2 min", "3 min"
  tips        String[] // Array of tip strings
  vocab       Json?    // Array of {word, ipa}
  phrases     String[] // Array of phrase strings
  recommended Boolean  @default(false)
  icon        String?  @default("üé§")
  color       String?  @default("blue")
  order       Int      @default(0)
  active      Boolean  @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([level])
  @@index([type])
  @@index([active, order])
}

// ------------------------------------------------------
// Grammar Tasks (for Grammar Practice)
// ------------------------------------------------------
model GrammarTask {
  id          String   @id @default(cuid())
  title       String
  level       String   // A1-A2, B1-B2, C1
  introduction String  @db.Text
  examples    Json?    // Array of example objects
  exercises   Json?    // Array of exercise objects
  exampleCount Int     @default(0)
  exerciseCount Int    @default(0)
  category    String?  // e.g., "Tenses", "Conditionals"
  recommended Boolean  @default(false)
  order       Int      @default(0)
  active      Boolean  @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([level])
  @@index([category])
  @@index([active, order])
}